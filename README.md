# 网格交易助手

## 这是什么?
一款帮助基金投资者实现网格交易策略的工具。通过简单的参数设置,自动计算买卖点位,实时提醒交易信号,让网格交易更轻松、更智能。

## 主要特性
- 🎯 傻瓜式网格策略设置 - 仅需设置买入/卖出网格宽度和网格数量
- 📊 实时市场概览 - 一眼掌握主要指数行情
- 💰 智能交易提醒 - 到达买卖点位距离呈现
- 📈 可视化分析 - 交易历史轨迹清晰呈现
- 💾 数据备份恢复 - 支持导入导出所有数据

## 用户场景
小明是一位普通金融消费者,他希望通过网格交易策略来投资指数基金,但是:
- 手动计算买卖点位太麻烦
- 经常错过最佳交易时机
- 没有清晰的交易记录和分析
- 数据随处记，回顾时找不到记录

使用网格交易助手后:
- 设置一次策略,自动计算买卖点位
- 到达买卖点位自动提醒
- 交易记录一目了然,收益分析一键生成
- 数据随时备份,换设备也不怕


## 项目状态
目前处于积极开发中（我和Cursor共建），欢迎提出建议和贡献代码。

## 项目介绍
提供网格化交易的信息展示、数据记录、自动计算、交易提醒等功能。
该产品使用了普适性技术栈，可以便捷迁移到其他端和微信小程序等主流平台。

## 功能特点
### 市场概览
-  实时展示主要市场指数（上证、沪深300、创业板、科创50等）
-  清晰的涨跌幅度展示（进度条可视化）
-  成交量和成交额数据展示
-  自动更新行情数据

### 基金功能
-  基金搜索（支持按代码和名称搜索）
-  基金详情展示
   -  基金名称和代码
   -  当前净值和估值
   -  涨跌幅数据
   -  基金经理信息
   -  基金规模
   -  成立日期
   -  基金类型
   -  风险等级
   -  历史业绩数据
-  网格交易策略设置
  -  支持设置买入网格宽度（百分比）
  -  支持设置卖出网格宽度（百分比）
  -  支持设置网格数量
  -  策略版本管理（一次只有一个策略生效）
  -  历史策略记录
  -  策略调整功能（仅在有变化时允许更新）
-  交易记录功能
  -  支持历史交易日期选择
  -  自动获取对应日期的净值数据
  -  买入金额输入（万元为单位）
  -  自动计算预期卖出净值
  -  实时更新当前净值和网格宽度
  -  预估下次操作的网格宽度
-  数据分析功能
   -  持仓收益统计
   -  历史交易分析
-  提醒功能
   -  买入信号提醒
   -  卖出信号提醒
-  买入/卖出操作界面
  -  堆栈式卖出操作（仅最新持仓可卖）
  -  卖出时自动获取对应日期净值
  -  实时计算盈亏情况
  -  已卖出记录置灰显示

### 界面设计
-  现代简约的设计风格
-  磨砂玻璃效果（backdrop-blur）
-  流畅的动画过渡效果
-  响应式布局，适配多种设备
-  优雅的数据可视化

## 用户旅程
1.  进入首页，展示一些宽基指数信息供参考。
2.  在页面顶部，可以随时：
    - 点击"导出数据"按钮，将所有数据导出为 JSON 文件备份
    - 点击"导入数据"按钮，选择备份文件进行恢复
      - 可以选择完全覆盖或合并导入模式
      - 导入前可以预览数据内容
      - 导入后自动刷新页面
3.  选择一个基金（提供基于名称/编号的下拉筛选），进入网格化交易页面。
4.  输入网格交易策略，只需要三个参数：
   - 买入网格宽度（百分比）：当基金净值下跌超过此百分比时触发买入信号
   - 卖出网格宽度（百分比）：当基金净值上涨超过此百分比时触发卖出信号
   - 网格数量（整数）：最多同时持有的网格数量
5.  记录网格交易历史，即用户输入一个交易日期，自动带出该日期网格交易数据。（当日净值，累计净值，买入金额，买入份额，预计卖出的净值，预计卖出的累计净值），其中买入金额需要用户输入，预计卖出按照卖出网格宽度自动计算
6.  当当前数据不是第一条的时候，和上一条数据进行比较，增加实际网格宽度列（实际网格宽度 = （当前累计净值 - 上一条累计净值）/ 上一条累计净值）
7.  新增的数据默认是持有状态，点击卖出按钮，自动计算卖出金额和卖出份额，并记录到表格中。（如果当日未收盘，则获取实时信息，给出预计卖出的分析，不修改数据）注意：只能卖出最末一条（操作类似堆栈），其他卖出按钮不可点击
8.  但是用户依然可以新增买入，已卖出的整行置灰，这样持仓的一目了然。
9.  实时显示当前净值、网格宽度和距离下次操作的网格宽度，并通过正负号标识是否已经达到或超出操作阈值，辅助用户决策。
10. 页面底部展示基金近30日的累计净值走势，并在图表中标注：
   -  买入点（红色标记）：显示买入金额或仅显示"买入"文字
   -  卖出点（带箭头虚线）：使用红绿色区分盈亏（盈利红色，亏损绿色），显示具体盈亏金额和比例
   -  支持图表缩放和拖动，方便查看历史数据
11. 在首页展示基金持仓概览：
    - 展示所有配置过网格策略的基金列表
    - 每个基金卡片显示：
      - 基金名称和代码
      - 当前持仓数量和网格使用情况
      - 实时盈亏统计（金额/比例）
      - 最近一次操作信息
      - 距离下次操作的网格宽度
    - 点击卡片可快速进入对应基金的详情页面
    - 支持按持仓数量、盈亏情况等进行排序
    - 可以设置关注的基金置顶显示

## 技术栈
- 前端框架：React 18 + TypeScript 5
- UI组件库：Ant Design 5.x
- 状态管理：Redux Toolkit + Redux Persist（数据持久化）
- 样式方案：Tailwind CSS + CSS-in-JS
- 图表库：ECharts 5.x（待集成）
- HTTP 客户端：Axios
- 日期处理：Day.js
- 构建工具：Vite 4
- 包管理器：pnpm

## 接口依赖
-  基金列表搜索：https://fundsuggest.eastmoney.com/FundSearch/api/FundSearchAPI.ashx
-  基金详情：https://fundgz.1234567.com.cn/js/{基金代码}.js
-  基金历史净值：http://api.fund.eastmoney.com/f10/lsjz
-  基金实时估值：https://fundgz.1234567.com.cn/js/{基金代码}.js
-  市场指数行情：https://hq.sinajs.cn/list=s_{基金代码}

## 部署说明

### 环境要求
- Node.js >= 18
- pnpm >= 8

### 本地开发
1. 安装依赖
```bash
pnpm install
```

2. 启动开发服务器
```bash
pnpm dev
```

3. 打开浏览器访问 http://localhost:5173

### 项目结构
```
src/
├── assets/           # 静态资源文件
├── components/       # 公共组件
│   ├── BackupModal/         # 数据导入弹窗组件
│   ├── FundChart/           # 基金走势图表组件
│   ├── FundList/           # 基金列表组件
│   ├── FundPortfolioOverview/  # 基金持仓概览组件
│   ├── FundSearch/        # 基金搜索组件
│   ├── GridStrategyForm/  # 网格策略表单组件
│   ├── Layout/           # 布局组件
│   ├── MarketCard/       # 市场指数卡片组件
│   ├── MarketIndex/      # 市场指数组件
│   ├── SellModal/        # 卖出确认弹窗组件
│   ├── TradeRecordForm/  # 交易记录表单组件
│   └── TradeRecordTable/ # 交易记录表格组件
├── hooks/            # 自定义 Hooks
├── layouts/          # 布局模板
├── pages/            # 页面组件
│   ├── Fund/        # 基金详情页
│   └── Home/        # 首页（市场概览）
├── services/         # API 服务
│   ├── api.ts       # API 配置
│   └── market.ts    # 市场数据服务
├── store/            # Redux 状态管理
│   ├── slices/      # Redux 切片
│   │   ├── fundStarSlice.ts    # 基金收藏状态管理
│   │   ├── gridStrategySlice.ts # 网格策略状态管理
│   │   ├── marketSlice.ts      # 市场数据状态管理
│   │   └── tradeRecordSlice.ts # 交易记录状态管理
│   └── index.ts     # Store 配置
├── types/            # TypeScript 类型定义
├── utils/            # 工具函数
│   ├── backup.ts    # 数据导入导出工具
│   └── ...         # 其他工具函数
├── App.css          # 应用级样式
├── App.tsx          # 应用入口组件
├── index.css        # 全局样式
├── main.tsx         # 应用入口文件
└── vite-env.d.ts    # Vite 环境类型声明
```

### 开发日志  
2025-01-22
- 新增数据导入导出功能
  - 实现数据备份导出
  - 实现数据导入恢复
  - 支持两种导入模式
- 优化基金信息获取
  - 完善基金信息数据解析逻辑
  - 提高数据提取的准确性和稳定性
- 优化网格距离计算和展示
  - 修改网格距离计算逻辑，同时显示买入和卖出两个方向的距离
  - 优化全部卖出后的网格距离计算，基于最后一次卖出价格继续计算
  - 优化交易记录表单，自动加载当日数据，无需手动选择日期
- 重构API配置管理
  - 统一开发和生产环境的API路径配置
  - 简化API配置结构，提高可维护性
  - 优化Vercel部署支持

2025-01-16
- 完成市场概览功能
  -  实现市场指数卡片布局
  -  实现市场指数卡片数据展示
  -  实现市场指数卡片数据更新
- 完成网格交易策略功能
  -  策略表单设计与实现
  -  策略状态管理（Redux）
  -  策略版本控制
  -  历史策略记录
  -  策略变更检测
  -  优化策略展示效果
- 完成交易记录功能
  -  交易记录表单设计与实现
  -  交易记录表格组件开发
  -  交易记录状态管理（Redux）
  -  买入/卖出功能实现
  -  实际网格宽度计算
  -  优化表格展示效果
- 完成交易历史可视化
  -  实现基金累计净值走势图
  -  优化买入点标注显示
  -  添加卖出点箭头指示
  -  集成盈亏信息展示
  -  支持图表交互操作
- 完成基金持仓概览
  -  实现基金列表布局
  -  实现基金卡片数据展示
  -  实现基金卡片数据更新